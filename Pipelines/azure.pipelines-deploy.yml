trigger: none   # Deployment should not run automatically on code push

resources:
  pipelines:
  - pipeline: validation
    source: Nabanita-Sahu.Validate   # ✅ Exact name of your validation pipeline
    trigger: true                    # ✅ Auto-trigger deploy after validation succeeds

pool:
  name: DevOpsPracticePool

stages:
- stage: Deploy
  displayName: "Deploy Stage"
  jobs:
  - job: DeployJob
    displayName: "Deploy Application"
    steps:

    # ✅ Correct artifact download using runPipelineName
    - task: DownloadPipelineArtifact@2
      displayName: 'Download build artifacts'
      inputs:
        source: 'specific'
        project: $(System.TeamProject)
        runPipelineName: Nabanita-Sahu.Validate   # ✅ Use actual pipeline name here
        runVersion: 'latest'
        artifact: 'drop'
        path: '$(Pipeline.Workspace)'

    # ✅ Deployment placeholder
    - script: |
        echo "Deploying application..."
        echo "Artifacts downloaded to $(Pipeline.Workspace)"
      displayName: "Deployment Step"